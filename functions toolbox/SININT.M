function y = sinint(x)
%y = sinint(x)
%sin integral = integrate( sin(t)/t,t,0,x )

%ei = expint(i*x);
%y = sign(x).*(pi/2) - (i/2)*(ei - conj(ei))

z1 = abs(x)<=1;
z2 = x>1;
z3 = x<-1;
y = x;
fn = x;
fd = x;
f = x;
gn = x;
gd = x;
g = x;

x2 = x.^2;
% 0<=abs(x)<=1
y(z1) = x(z1).*(1.0 - x2(z1).*(0.05555555555555555 - x2(z1).*(1.666666667e-3 - x2(z1).*(2.834467120e-5 - x2(z1).*(3.061924e-7 - x2(z1).*(2.27746e-9 - x2(z1).*1.2353e-011))))));

% 1<=x<=inf
fn(~z1) = 38.102495 + x2(~z1).*(335.677320 + x2(~z1).*(265.187033 + x2(~z1).*(38.027264 + x2(~z1))));
fd(~z1) = 157.105423 + x2(~z1).*(570.236280+ x2(~z1).*(322.624911 + x2(~z1).*(40.021433 + x2(~z1))));
f(~z1) = fn(~z1)./(fd(~z1).*x(~z1));
gn(~z1) = 21.821899 + x2(~z1).*(352.018498 + x2(~z1).*(302.757865 + x2(~z1).*(42.242855 + x2(~z1))));
gd(~z1) = 449.690326+ x2(~z1).*(1114.978885+ x2(~z1).*(482.485984 + x2(~z1).*(48.196927 + x2(~z1))));
g(~z1) = gn(~z1)./(gd(~z1).*x2(~z1));
y(z2) = 0.5*pi - f(z2).*cos(x(z2)) - g(z2).*sin(x(z2));
y(z3) =-0.5*pi - f(z3).*cos(x(z3)) - g(z3).*sin(x(z3));